{% extends 'base.html' %}
{% block content %}
  {% load static %}

  <div class="container-fluid px-4 py-5">
    <div class="row justify-content-center">
      <div class="col-12" style="max-width: 1600px;">
        <!-- کادر بزرگ -->
        <div class="card border-0 shadow-lg rounded-4 overflow-hidden">
          <div class="card-body p-4 p-md-5">
            <!-- گالری تصاویر -->
            {% if images %}
              <h4 class="text-center mb-4 text-primary">گالری تصاویر پروژه</h4>
              <div class="row g-3 mb-5">
                {% for img in images %}
                  <div class="col-6 col-md-4 col-lg-3">
                    <a href="{{ img.url }}" target="_blank"><img src="{{ img.url }}" class="img-fluid rounded shadow gallery-img" alt="تصویر پروژه" /></a>
                  </div>
                {% endfor %}
              </div>
            {% endif %}

            <!-- عنوان + پوستر -->
            <div class="text-center mb-5">
              <h1 class="display-5 fw-bold text-dark">{{ service.name }}</h1>
              <a href="{{ service.link }}" target="_blank" class="btn btn-success btn-lg mt-3">بازدید از سایت</a>
            </div>

            <!-- توضیحات کوتاه -->
            {% if service.short_discription %}
              <div class="alert alert-light border-start border-primary border-4 mb-4">
                <p class="lead text-muted mb-0">{{ service.short_discription }}</p>
              </div>
            {% endif %}

            <!-- توضیحات بلند (قابل گسترش) -->
            {% if service.long_discription %}
              <div class="card border-0 shadow-sm mb-4">
                <div class="card-header bg-gradient bg-primary text-white">
                  <button class="btn btn-link text-white text-decoration-none fw-bold collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#longDesc">توضیحات کامل پروژه</button>
                </div>
                <div class="collapse" id="longDesc">
                  <div class="card-body text-justify bg-light">{{ service.long_discription|linebreaks }}</div>
                </div>
              </div>
            {% endif %}

            <!-- اطلاعات کلی -->
            <div class="row g-3 mb-4 text-center">
              <div class="col-sm-4">
                <div class="p-3 bg-gradient bg-info text-white rounded shadow-sm">
                  <small class="d-block">دسته‌بندی</small>
                  <p class="mb-0 fw-bold fs-5">{{ service.category }}</p>
                </div>
              </div>
              <div class="col-sm-4">
                <div class="p-3 bg-gradient bg-warning text-dark rounded shadow-sm">
                  <small class="d-block">زمان تحویل</small>
                  <p class="mb-0 fw-bold fs-5">{{ service.delivery_time|default:'—' }}</p>
                </div>
              </div>
              <div class="col-sm-4">
                <div class="p-3 bg-gradient {% if 'فعال' in service.status|default:'' %}
                    bg-success text-white
                  {% else %}
                    bg-secondary text-white
                  {% endif %} rounded shadow-sm">
                  <small class="d-block">وضعیت</small>
                  <p class="mb-0 fw-bold fs-5">{{ service.status|default:'نامشخص' }}</p>
                </div>
              </div>
            </div>

            <!-- تکنولوژی‌ها -->
            {% if service.frontend or service.backend or service.hosting or service.authentication %}
              <div class="card border-0 shadow-sm mb-4">
                <div class="card-header bg-dark text-white">
                  <h5 class="mb-0">تکنولوژی‌های استفاده شده</h5>
                </div>
                <div class="card-body bg-light">
                  <div class="row text-center">
                    {% if service.frontend %}
                      <div class="col-6 col-md-3 mb-3">
                        <span class="badge bg-info text-dark w-100 p-2 fs-6">Frontend: {{ service.frontend }}</span>
                      </div>
                    {% endif %}
                    {% if service.backend %}
                      <div class="col-6 col-md-3 mb-3">
                        <span class="badge bg-warning text-dark w-100 p-2 fs-6">Backend: {{ service.backend }}</span>
                      </div>
                    {% endif %}
                    {% if service.hosting %}
                      <div class="col-6 col-md-3 mb-3">
                        <span class="badge bg-secondary w-100 p-2 fs-6">Hosting: {{ service.hosting }}</span>
                      </div>
                    {% endif %}
                    {% if service.authentication %}
                      <div class="col-12 mb-3">
                        <span class="badge bg-danger w-100 p-2 fs-6">Authentication: {{ service.authentication }}</span>
                      </div>
                    {% endif %}
                  </div>
                </div>
              </div>
            {% endif %}

            <!-- PageSpeed -->
            {% if service.pagespeed %}
              <div class="text-center mb-5 p-4 bg-white rounded shadow-sm">
                <h5 class="mb-3 text-success">امتیاز PageSpeed</h5>
                <div class="progress rounded-pill" style="height: 40px;">
                  <div class="progress-bar bg-success fw-bold fs-5" style="width: {{ service.pagespeed }}%">{{ service.pagespeed|floatformat:3 }} / 100</div>
                </div>
              </div>
            {% endif %}

            <!-- دکمه برگشت -->
            <div class="text-center mt-5">
              <a href="{% url 'service' %}" class="btn btn-outline-primary btn-lg px-5">برگشت به لیست پروژه‌ها</a>
            </div>
          </div>
        </div>
        <!-- پایان کادر بزرگ -->
      </div>
    </div>
  </div>

  <style>
    
    .gallery-grid {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
    }
    .gallery-item {
      flex: 0 0 calc(50% - 1.5rem); /* موبایل: 2 ستون */
      max-width: calc(50% - 1.5rem);
    }
    
    .gallery-img {
      width: 300px;
      height: 300px;
      object-fit: cover;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      transition: all 0.3s ease;
      margin-bottom: 15px;
    }
    .gallery-img:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.25);
    }
  </style>
{% endblock %}
